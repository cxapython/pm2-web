# pm2-web

[![Node.js 25+](https://img.shields.io/badge/node-%3E%3D25.0.0-brightgreen)](https://nodejs.org/)
[![PM2 5.x](https://img.shields.io/badge/pm2-%3E%3D5.0.0-blue)](https://pm2.keymetrics.io/)

[PM2](https://github.com/Unitech/pm2) è¿›ç¨‹ç®¡ç†å™¨çš„ Web ç›‘æ§ç•Œé¢ã€‚

![pm2-web æˆªå›¾](https://raw.github.com/cxapython/pm2-web/master/assets/screenshot-1.0.png)

![åœ¨çº¿ç¼–è¾‘ä»£ç ](https://raw.github.com/cxapython/pm2-web/master/assets/screenshot-0.0.png)

## ç‰¹æ€§

- ğŸ–¥ï¸ å®æ—¶ç›‘æ§ PM2 ç®¡ç†çš„æ‰€æœ‰è¿›ç¨‹
- ğŸ“Š æ˜¾ç¤º CPUã€å†…å­˜ä½¿ç”¨ç‡å’Œç³»ç»Ÿè´Ÿè½½
- ğŸ”„ æ”¯æŒåœæ­¢ã€é‡å¯ã€é‡è½½è¿›ç¨‹
- ğŸ“ å®æ—¶æ—¥å¿—è¾“å‡ºæŸ¥çœ‹
- âœï¸ **åœ¨çº¿ä»£ç ç¼–è¾‘å™¨** - ç›´æ¥æŸ¥çœ‹å’Œç¼–è¾‘è¿›ç¨‹æºä»£ç 
- ğŸ”— **ä¾èµ–æ–‡ä»¶è·³è½¬** - è‡ªåŠ¨è§£æå¹¶è·³è½¬åˆ°æœ¬åœ°ä¾èµ–æ–‡ä»¶
- ğŸ”’ æ”¯æŒ HTTP åŸºæœ¬è®¤è¯
- ğŸ” æ”¯æŒ HTTPS/SSL
- âš¡ WebSocket å®æ—¶æ•°æ®æ›´æ–°

## ç³»ç»Ÿè¦æ±‚

- **Node.js** >= 18.0.0 (å·²æµ‹è¯•æ”¯æŒ Node.js 25)
- **PM2** >= 5.0.0

## å®‰è£…

### å…¨å±€å®‰è£…ï¼ˆæ¨èï¼‰

```bash
npm install -g pm2-web
```

### æœ¬åœ°å®‰è£…

```bash
git clone https://github.com/achingbrain/pm2-web.git
cd pm2-web
npm install
```

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨

```bash
# å…¨å±€å®‰è£…å
pm2-web

# æˆ–æœ¬åœ°è¿è¡Œ
npm start

# æˆ–å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev
```

å¯åŠ¨åè®¿é—® `http://localhost:9000` å³å¯æŸ¥çœ‹ PM2 è¿›ç¨‹ç›‘æ§ç•Œé¢ã€‚

## é…ç½®

pm2-web ä¼šæŒ‰ä»¥ä¸‹é¡ºåºåŠ è½½é…ç½®æ–‡ä»¶ï¼š

1. å‘½ä»¤è¡Œå‚æ•° `--config /path/to/config.json`
2. ç”¨æˆ·é…ç½®æ–‡ä»¶ `~/.config/pm2-web/config.json`
3. å…¨å±€é…ç½®æ–‡ä»¶ `/etc/pm2-web/config.json`

### é…ç½®æ–‡ä»¶ç¤ºä¾‹

```json
{
  "www": {
    "host": "localhost",
    "address": "0.0.0.0",
    "port": 9000,
    "authentication": {
      "enabled": false,
      "username": "admin",
      "password": "password"
    },
    "ssl": {
      "enabled": false,
      "port": 9001,
      "key": "/path/to/key.pem",
      "certificate": "/path/to/cert.pem"
    }
  },
  "updateFrequency": 5000,
  "logs": {
    "max": 1000
  }
}
```

### å¸¸ç”¨é…ç½®é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `www:port` | HTTP æœåŠ¡ç«¯å£ | 9000 |
| `www:address` | ç»‘å®šåœ°å€ | 0.0.0.0 |
| `www:authentication:enabled` | å¯ç”¨ HTTP åŸºæœ¬è®¤è¯ | false |
| `www:ssl:enabled` | å¯ç”¨ HTTPS | false |
| `updateFrequency` | æ•°æ®åˆ·æ–°é¢‘ç‡ï¼ˆæ¯«ç§’ï¼‰ | 5000 |
| `logs:max` | æ¯ä¸ªè¿›ç¨‹ä¿ç•™çš„æœ€å¤§æ—¥å¿—è¡Œæ•° | 1000 |

### å‘½ä»¤è¡Œå‚æ•°

æ‰€æœ‰é…ç½®é€‰é¡¹éƒ½å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œä¼ é€’ï¼š

```bash
pm2-web --www:port 8080 --www:authentication:enabled true
```

## HTTP è®¤è¯

å¯ç”¨ HTTP åŸºæœ¬è®¤è¯ï¼š

```json
{
  "www": {
    "authentication": {
      "enabled": true,
      "username": "your_username",
      "password": "your_password"
    }
  }
}
```

âš ï¸ **æ³¨æ„**ï¼šå¯†ç ä»¥æ˜æ–‡ä¼ è¾“ï¼Œå»ºè®®åŒæ—¶å¯ç”¨ SSLã€‚

## SSL/HTTPS æ”¯æŒ

1. ç”Ÿæˆè¯ä¹¦ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰ï¼š

```bash
cd certs
./generate_certificate.sh
```

2. é…ç½® SSLï¼š

```json
{
  "www": {
    "ssl": {
      "enabled": true,
      "port": 9001,
      "passphrase": "your_passphrase",
      "key": "/path/to/server.key",
      "certificate": "/path/to/server.crt"
    }
  }
}
```

## è¿›ç¨‹ç®¡ç†

åœ¨ Web ç•Œé¢ä¸­å¯ä»¥å¯¹æ¯ä¸ªè¿›ç¨‹æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

- **åœæ­¢ (Stop)**: åœæ­¢è¿›ç¨‹
- **é‡å¯ (Restart)**: åœæ­¢å¹¶é‡æ–°å¯åŠ¨è¿›ç¨‹ï¼ˆä¼šæ–­å¼€è¿æ¥ï¼‰
- **é‡è½½ (Reload)**: ä¼˜é›…é‡è½½ï¼ˆé›¶åœæœºæ—¶é—´ï¼‰
- **ç¼–è¾‘ä»£ç **: æ‰“å¼€åœ¨çº¿ä»£ç ç¼–è¾‘å™¨

## åœ¨çº¿ä»£ç ç¼–è¾‘

pm2-web æä¾›äº†å¼ºå¤§çš„åœ¨çº¿ä»£ç ç¼–è¾‘åŠŸèƒ½ï¼Œè®©æ‚¨å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹å’Œä¿®æ”¹è¿è¡Œä¸­è¿›ç¨‹çš„æºä»£ç ã€‚

### åŠŸèƒ½ç‰¹æ€§

- ğŸ¨ **Monaco Editor** - ä½¿ç”¨ VS Code åŒæ¬¾ç¼–è¾‘å™¨ï¼Œæ”¯æŒè¯­æ³•é«˜äº®
- ğŸ’¾ **å®æ—¶ä¿å­˜** - Ctrl+S å¿«æ·é”®ä¿å­˜ï¼Œè‡ªåŠ¨åˆ›å»ºå¤‡ä»½
- ğŸ”„ **ä¿å­˜å¹¶é‡å¯** - ä¸€é”®ä¿å­˜ä»£ç å¹¶é‡å¯è¿›ç¨‹
- ğŸ“ **æ–‡ä»¶æµè§ˆå™¨** - æµè§ˆé¡¹ç›®ç›®å½•ç»“æ„
- ğŸ”— **ä¾èµ–è·³è½¬** - è‡ªåŠ¨è§£æ Python/Node.js çš„æœ¬åœ°å¯¼å…¥ï¼Œç‚¹å‡»è·³è½¬ç¼–è¾‘
- ğŸ“œ **ç¼–è¾‘å†å²** - æ”¯æŒè¿”å›ä¹‹å‰ç¼–è¾‘çš„æ–‡ä»¶

### ä½¿ç”¨æ–¹æ³•

1. åœ¨è¿›ç¨‹åˆ—è¡¨ä¸­ç‚¹å‡» **ç¼–è¾‘ä»£ç ** æŒ‰é’®ï¼ˆä»£ç å›¾æ ‡ï¼‰
2. ç¼–è¾‘å™¨ä¼šè‡ªåŠ¨åŠ è½½è¿›ç¨‹çš„ä¸»è„šæœ¬æ–‡ä»¶
3. å³ä¾§æ˜¾ç¤ºè¯¥æ–‡ä»¶çš„æœ¬åœ°ä¾èµ–ï¼Œç‚¹å‡»å¯è·³è½¬ç¼–è¾‘
4. ä¿®æ”¹ä»£ç åï¼Œç‚¹å‡» **ä¿å­˜** æˆ– **ä¿å­˜å¹¶é‡å¯**

### æ”¯æŒçš„æ–‡ä»¶ç±»å‹

- Python: `.py`
- JavaScript/TypeScript: `.js`, `.ts`, `.jsx`, `.tsx`, `.mjs`
- JSON: `.json`
- YAML: `.yaml`, `.yml`
- Shell: `.sh`, `.bash`
- å…¶ä»–: `.html`, `.css`, `.md`, `.txt` ç­‰

### ä¾èµ–è§£æ

**Python æ–‡ä»¶**:
- è§£æ `import xxx` å’Œ `from xxx import yyy` è¯­å¥
- è‡ªåŠ¨æŸ¥æ‰¾æœ¬åœ°æ¨¡å—æ–‡ä»¶

**Node.js æ–‡ä»¶**:
- è§£æ `require('xxx')` å’Œ `import xxx from 'xxx'` è¯­å¥
- åªæ˜¾ç¤ºç›¸å¯¹è·¯å¾„çš„æœ¬åœ°ä¾èµ–ï¼ˆä»¥ `.` å¼€å¤´ï¼‰

### å®‰å…¨è¯´æ˜

- åªå…è®¸ç¼–è¾‘ç‰¹å®šç±»å‹çš„æºä»£ç æ–‡ä»¶
- æ¯æ¬¡ä¿å­˜è‡ªåŠ¨åˆ›å»º `.backup.{timestamp}` å¤‡ä»½æ–‡ä»¶
- æ–‡ä»¶å¤§å°é™åˆ¶ä¸º 5MB

### è½¯é‡è½½ vs ç¡¬é‡è½½

é»˜è®¤ä½¿ç”¨è½¯é‡è½½ï¼ŒPM2 ä¼šå…ˆå‘é€ `shutdown` æ¶ˆæ¯ï¼Œç­‰å¾…è¿›ç¨‹æ¸…ç†èµ„æºåå†ç»ˆæ­¢ã€‚

è¦ä½¿ç”¨ç¡¬é‡è½½ï¼ˆç«‹å³ç»ˆæ­¢ï¼‰ï¼Œåœ¨é…ç½®ä¸­è®¾ç½®ï¼š

```json
{
  "forceHardReload": true
}
```

ç›‘å¬ shutdown æ¶ˆæ¯ï¼š

```javascript
process.on("message", function(message) {
  if (message === "shutdown") {
    // æ¸…ç†èµ„æºï¼ˆå…³é—­æ•°æ®åº“è¿æ¥ç­‰ï¼‰
    cleanup();
    process.exit(0);
  }
});
```

## å›¾è¡¨é…ç½®

èµ„æºä½¿ç”¨å›¾è¡¨æ”¯æŒè‡ªå®šä¹‰æ•°æ®ç‚¹æ•°é‡å’Œæ—¶é—´åˆ†å¸ƒï¼š

```json
{
  "graph": {
    "datapoints": 1000,
    "distribution": [40, 25, 10, 10, 5]
  }
}
```

- `datapoints`: å›¾è¡¨æ˜¾ç¤ºçš„æœ€å¤§æ•°æ®ç‚¹æ•°
- `distribution`: æŒ‰å¤©åˆ†å¸ƒæ¯”ä¾‹ï¼Œæ•°ç»„ç¬¬ä¸€é¡¹æ˜¯ä»Šå¤©çš„æ•°æ®å æ¯”

## è°ƒè¯•è¿›ç¨‹

è¦è°ƒè¯•è¿è¡Œä¸­çš„è¿›ç¨‹ï¼Œéœ€è¦åœ¨è¿›ç¨‹å¯åŠ¨æ—¶æŒ‡å®šè°ƒè¯•ç«¯å£ï¼š

```bash
pm2 start --node-args="--inspect=9229" app.js
```

ç„¶ååœ¨é…ç½®ä¸­æŒ‡å®š inspector ç«¯å£ï¼š

```json
{
  "pm2": [{
    "host": "localhost",
    "inspector": 9229
  }]
}
```

## ç‰ˆæœ¬å†å²

### 3.1.0 (2026)

- âœ¨ æ–°å¢åœ¨çº¿ä»£ç ç¼–è¾‘å™¨åŠŸèƒ½
- âœ¨ æ”¯æŒ Monaco Editorï¼ˆVS Code åŒæ¬¾ç¼–è¾‘å™¨ï¼‰
- âœ¨ æ”¯æŒä¿å­˜ä»£ç å¹¶ä¸€é”®é‡å¯è¿›ç¨‹
- âœ¨ è‡ªåŠ¨è§£æ Python/Node.js æœ¬åœ°ä¾èµ–å¹¶æ”¯æŒè·³è½¬ç¼–è¾‘
- âœ¨ æ”¯æŒæ–‡ä»¶æµè§ˆå™¨æµè§ˆé¡¹ç›®ç›®å½•
- âœ¨ è‡ªåŠ¨åˆ›å»ºæ–‡ä»¶å¤‡ä»½
- ğŸ”§ ä¿®å¤ html-entities API å…¼å®¹æ€§é—®é¢˜
- ğŸ”§ ä¿®å¤ Angular $apply é‡å¤è°ƒç”¨é—®é¢˜

### 3.0.0 (2026)

- ğŸ‰ æ”¯æŒ Node.js 25
- â¬†ï¸ å‡çº§ Express 4.x
- â¬†ï¸ å‡çº§ ws 8.x
- â¬†ï¸ å‡çº§ winston 3.x
- â¬†ï¸ ä½¿ç”¨ pug æ›¿æ¢ jade
- â¬†ï¸ ä½¿ç”¨ PM2 programmatic API æ›¿æ¢å·²åºŸå¼ƒçš„ pm2-interface
- ğŸ”§ ä¿®å¤å¤šä¸ªå…¼å®¹æ€§é—®é¢˜

### 2.0.x

- ä½¿ç”¨ pm2-interface 2.x ç‰ˆæœ¬

### 1.x.x

- åˆå§‹ç‰ˆæœ¬
- è¿›ç¨‹åˆ—è¡¨ã€å¯åœé‡å¯
- èµ„æºä½¿ç”¨å›¾è¡¨
- æ—¥å¿—æŸ¥çœ‹
- HTTP è®¤è¯å’Œ SSL æ”¯æŒ

## å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼è¿è¡Œï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev

# è¿è¡Œæµ‹è¯•
npm test
```

## è´¡çŒ®

æ¬¢è¿æäº¤ Pull Requestï¼è¯·ç¡®ä¿ï¼š

1. ä»£ç é€šè¿‡æµ‹è¯•
2. éµå¾ªç°æœ‰ä»£ç é£æ ¼
3. æ›´æ–°ç›¸å…³æ–‡æ¡£

## è®¸å¯è¯

MIT License

## è‡´è°¢

- åŸä½œè€… [achingbrain](http://github.com/achingbrain)
- [PM2](https://github.com/unitech/pm2) å›¢é˜Ÿ
- [reconnecting-websocket](https://github.com/joewalnes/reconnecting-websocket) by [joewalnes](https://github.com/joewalnes)
